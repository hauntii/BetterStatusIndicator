function C(n){window.enmity.plugins.registerPlugin(n)}const y=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const t=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const F=window.enmity.modules.common.Navigation;window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme;const b=window.enmity.modules.common.Linking,R=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function A(n){return window.enmity.patcher.create(n)}var k="PlatformIndicators",E="1.0.0",P="Reveal statuses for every platform user is using",L=[{name:"mafu",id:"519760564755365888"}],_="#da70d6",x={name:k,version:E,description:P,authors:L,color:_};const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList;const S=e.Image;e.ImageBackground,e.KeyboardAvoidingView,e.Modal;const B=e.Pressable;e.RefreshControl;const D=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch;const h=e.Text;e.TextInput,e.TouchableHighlight,e.TouchableOpacity,e.TouchableWithoutFeedback,e.Touchable;const g=e.View;e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox,e.FormDivider,e.FormHint,e.FormIcon,e.FormInput,e.FormLabel,e.FormRadio;const l=e.FormRow,N=e.FormSection;e.FormSelect,e.FormSubLabel,e.FormSwitch,e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;function w(n){return window.enmity.assets.getIDByName(n)}function T(...n){return window.enmity.modules.getByProps(...n)}function M(...n){return window.enmity.modules.getByName(...n)}window.enmity.modules.common;const V=w("img_account_sync_github_white"),O=w("Discord"),H=w("img_account_sync_twitter_white"),z=T("acceptInviteAndTransitionToInviteChannel");var U=({settings:n})=>{const o=R.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:y.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:y.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:y.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}});return t.createElement(D,null,t.createElement(g,{style:o.container},t.createElement(S,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:o.image}),t.createElement(g,{style:o.title},t.createElement(h,{style:o.name},"PlatformIndicators"),t.createElement(h,{style:o.author},"by mafu"))),t.createElement(N,{title:"INFORMATION"},t.createElement(l,{label:"Follow me on Twitter",style:o.info,trailing:l.Arrow,leading:t.createElement(l.Icon,{source:H}),onPress:()=>{b.openURL("https://twitter.com/m4fn3")}}),t.createElement(l,{label:"Visit my server for help",style:o.info,trailing:l.Arrow,leading:t.createElement(l.Icon,{source:O}),onPress:()=>{z.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{F.pop()}})}}),t.createElement(l,{label:"Check Source on GitHub",style:o.info,trailing:l.Arrow,leading:t.createElement(l.Icon,{source:V}),onPress:()=>{b.openURL("https://github.com/m4fn3/PlatformIndicators")}})),t.createElement(h,{style:o.footer},`v${E}`))};function I(n,o,d){return window.enmity.utilities.findInReactTree(n,o,d)}const p=A("PlatformIndicators"),f=T("setCurrentUserOnConnectionOpen"),Y=M("ProfileBadges",{all:!0,default:!1}),$=w("ic_mobile_status"),j=w("ic_monitor_24px"),q=w("ic_public");function G(n){let o="#747f8d";return n=="online"?o="#3ba55c":n=="idle"?o="#faa61a":n=="dnd"?o="#ed4245":n=="streaming"&&(o="#593695"),o}function c({client:n,stat:o}){let d=q,r;return n=="desktop"?(d=j,r={}):n=="mobile"?(d=$,r={marginRight:5,marginLeft:8}):n=="web"&&(r={height:20,width:20,marginRight:2,marginLeft:2}),t.createElement(S,{source:d,style:{tintColor:G(o),marginLeft:5,...r}})}function v({statuses:n}){return t.createElement(g,{style:{flexDirection:"row",marginRight:10,alignItems:"center"}},...n)}const K={...x,onStart(){p.after(B.type,"render",(o,d,r)=>{const a=I(r,i=>{var m;return((m=i.props)==null?void 0:m.children[0][1].type.name)=="FriendPresence"});if(a){let i=[];const m=a.props.children[0][1].props.userId,s=f.getState().clientStatuses[m];s&&(s.desktop&&i.unshift(t.createElement(c,{client:"desktop",stat:s.desktop})),s.mobile&&i.unshift(t.createElement(c,{client:"mobile",stat:s.mobile})),s.web&&i.unshift(t.createElement(c,{client:"web",stat:s.web})),i.length&&r.props.children[0].splice(-1,0,t.createElement(v,{statuses:i})))}});const n=p.after(g,"render",(o,d,r)=>{const a=I(r,i=>i.props.type==="MEMBER");a&&(p.after(a.type,"type",(i,[m],s)=>{const u=f.getState().clientStatuses[m.userId];u&&(u.web&&s.props.children.push(t.createElement(c,{client:"web",stat:u.web})),u.mobile&&s.props.children.push(t.createElement(c,{client:"mobile",stat:u.mobile})),u.desktop&&s.props.children.push(t.createElement(c,{client:"desktop",stat:u.desktop})))}),n())});Y.forEach(o=>{p.after(o,"default",(d,[r],a)=>{let i=[];const m=f.getState().clientStatuses[r.user.id];if(m&&(m.desktop&&i.unshift(t.createElement(c,{client:"desktop",stat:m.desktop})),m.mobile&&i.unshift(t.createElement(c,{client:"mobile",stat:m.mobile})),m.web&&i.unshift(t.createElement(c,{client:"web",stat:m.web})),i.length))if(a)(a.props.badges?a.props.badges:a.props.children).unshift(...i);else return t.createElement(v,{statuses:i})})})},onStop(){p.unpatchAll()},getSettingsPanel({settings:n}){return t.createElement(U,{settings:n})}};C(K);
