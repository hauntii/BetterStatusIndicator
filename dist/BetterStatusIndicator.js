function H(n){window.enmity.plugins.registerPlugin(n)}const S=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const e=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const z=window.enmity.modules.common.Navigation;window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme;const L=window.enmity.modules.common.Linking,P=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function U(n){return window.enmity.patcher.create(n)}var i="BetterStatusIndicator",B="0.0.2",Y="Reveal statuses for every platform user is using",$=[{name:"mafu",id:"519760564755365888"}],j="#da70d6",q={name:i,version:B,description:Y,authors:$,color:j};const{components:t}=window.enmity;t.Alert,t.Button,t.FlatList;const D=t.Image;t.ImageBackground,t.KeyboardAvoidingView,t.Modal;const G=t.Pressable;t.RefreshControl;const K=t.ScrollView;t.SectionList,t.StatusBar,t.StyleSheet,t.Switch;const T=t.Text;t.TextInput,t.TouchableHighlight,t.TouchableOpacity,t.TouchableWithoutFeedback,t.Touchable;const E=t.View;t.VirtualizedList,t.Form,t.FormArrow,t.FormCTA,t.FormCTAButton,t.FormCardSection,t.FormCheckbox,t.FormDivider,t.FormHint,t.FormIcon,t.FormInput,t.FormLabel,t.FormRadio;const m=t.FormRow,I=t.FormSection;t.FormSelect,t.FormSubLabel;const v=t.FormSwitch;t.FormTernaryCheckBox,t.FormText,t.FormTextColors,t.FormTextSizes;function g(n){return window.enmity.assets.getIDByName(n)}function F(...n){return window.enmity.modules.getByProps(...n)}function R(...n){return window.enmity.modules.getByName(...n)}window.enmity.modules.common;function y(n){return"#"+("000000"+n.toString(16)).slice(-6)}const M=F("openLazy","hideActionSheet"),W=R("CustomColorPickerActionSheet",{default:!1}).default;function C({label:n,color:o,setColor:a,leading:s,onSelect:c=void 0}){const r=P.createThemedStyleSheet({pickedColorText:{color:S.ThemeColorMap.TEXT_NORMAL,marginLeft:10,fontSize:16,width:72,fontFamily:S.Fonts.PRIMARY_MEDIUM},pickerColorPreview:{width:24,height:24,backgroundColor:y(o),borderRadius:3,borderWidth:1,borderColor:S.ThemeColorMap.HEADER_SECONDARY}});return e.createElement(m,{label:n,trailing:e.createElement(E,{style:{flexDirection:"row",alignItems:"center"}},e.createElement(E,{style:r.pickerColorPreview}),e.createElement(T,{style:r.pickedColorText},y(o)),e.createElement(m.Arrow,null)),leading:e.createElement(m.Icon,{source:g(s),style:{tintColor:y(o)}}),onPress:()=>{setTimeout(()=>{M.openLazy(new Promise(l=>l({default:W})),"CustomColorPickerActionSheet",{color:o,onSelect:l=>{a(l),c&&c(l),M.hideActionSheet()}})},300)}})}function p(n,o,a){window.enmity.settings.set(n,o,a)}function w(n,o,a){return window.enmity.settings.get(n,o,a)}const X=g("img_account_sync_github_white"),J=g("Discord"),Q=g("img_account_sync_twitter_white"),Z=g("ic_message_retry"),ee=g("ic_members"),te=g("ic_friend_wave_24px"),ne=g("ic_profile_24px"),oe=F("acceptInviteAndTransitionToInviteChannel");var ie=({settings:n})=>{const o=P.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:25,paddingTop:20,paddingLeft:20,paddingRight:30,color:S.ThemeColorMap.HEADER_PRIMARY,fontFamily:S.Fonts.PRIMARY_MEDIUM},author:{fontSize:15,paddingLeft:50,color:S.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:S.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}}),[a,s]=e.useState(w(i,"online",3908956)),[c,r]=e.useState(w(i,"offline",7634829)),[l,u]=e.useState(w(i,"idle",16426522)),[f,_]=e.useState(w(i,"dnd",15548997)),[V,k]=e.useState(w(i,"streaming",5846677));return e.createElement(K,null,e.createElement(E,{style:o.container},e.createElement(D,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:o.image}),e.createElement(E,{style:o.title},e.createElement(T,{style:o.name},"BetterStatusIndicator"),e.createElement(T,{style:o.author},"by mafu"))),e.createElement(I,{title:"COLOR"},e.createElement(C,{label:"Online",color:a,setColor:s,leading:"StatusOnline",onSelect:d=>{p(i,"online",d)}}),e.createElement(C,{label:"Offline",color:c,setColor:r,leading:"StatusOffline",onSelect:d=>{p(i,"offline",d)}}),e.createElement(C,{label:"Idle",color:l,setColor:u,leading:"StatusIdle",onSelect:d=>{p(i,"idle",d)}}),e.createElement(C,{label:"DND",color:f,setColor:_,leading:"StatusDND",onSelect:d=>{p(i,"dnd",d)}}),e.createElement(C,{label:"Streaming",color:V,setColor:k,leading:"StatusStreaming",onSelect:d=>{p(i,"streaming",d)}}),e.createElement(m,{label:"Reset to default",trailing:m.Arrow,leading:e.createElement(m.Icon,{source:Z}),onPress:()=>{p(i,"offline",7634829),r(7634829),p(i,"online",3908956),s(3908956),p(i,"idle",16426522),u(16426522),p(i,"dnd",15548997),_(15548997),p(i,"streaming",5846677),k(5846677)}})),e.createElement(I,{title:"PLACE"},e.createElement(m,{label:"Member List",leading:e.createElement(m.Icon,{source:ee}),trailing:e.createElement(v,{value:n.getBoolean("member",!0),onValueChange:d=>{n.set("member",d)}})}),e.createElement(m,{label:"Friends Tab",leading:e.createElement(m.Icon,{source:te}),trailing:e.createElement(v,{value:n.getBoolean("friend",!0),onValueChange:d=>{n.set("friend",d)}})}),e.createElement(m,{label:"Profile",leading:e.createElement(m.Icon,{source:ne}),trailing:e.createElement(v,{value:n.getBoolean("profile",!0),onValueChange:d=>{n.set("profile",d)}})})),e.createElement(I,{title:"INFORMATION"},e.createElement(m,{label:"Follow me on Twitter",style:o.info,trailing:m.Arrow,leading:e.createElement(m.Icon,{source:Q}),onPress:()=>{L.openURL("https://twitter.com/m4fn3")}}),e.createElement(m,{label:"Visit my server for help",style:o.info,trailing:m.Arrow,leading:e.createElement(m.Icon,{source:J}),onPress:()=>{oe.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{z.pop()}})}}),e.createElement(m,{label:"Check Source on GitHub",style:o.info,trailing:m.Arrow,leading:e.createElement(m.Icon,{source:X}),onPress:()=>{L.openURL("https://github.com/m4fn3/BetterStatusIndicator")}})),e.createElement(T,{style:o.footer},`v${B}`))};function x(n,o,a){return window.enmity.utilities.findInReactTree(n,o,a)}const b=U("BetterStatusIndicator"),A=F("setCurrentUserOnConnectionOpen"),re=R("ProfileBadges",{all:!0,default:!1}),le=R("Status",{default:!1}),me=g("ic_mobile_status"),ae=g("ic_monitor_24px"),se=g("ic_public");function N(n){let o=y(w(i,"offline",7634829));return n=="online"?o=y(w(i,"online",3908956)):n=="idle"?o=y(w(i,"idle",16426522)):n=="dnd"?o=y(w(i,"dnd",15548997)):n=="streaming"&&(o=y(w(i,"streaming",5846677))),o}function h({client:n,stat:o}){let a=se,s;return n=="desktop"?(a=ae,s={}):n=="mobile"?(a=me,s={marginRight:5,marginLeft:8}):n=="web"&&(s={height:20,width:20,marginRight:2,marginLeft:2}),e.createElement(D,{source:a,style:{tintColor:N(o),marginLeft:5,...s}})}function O({statuses:n}){return e.createElement(E,{style:{flexDirection:"row",marginRight:10,alignItems:"center"}},...n)}const ce={...q,onStart(){b.after(le,"default",(o,[a],s)=>{s.props.children.props.style.tintColor=N(a.status)}),b.after(G.type,"render",(o,a,s)=>{if(w(i,"friend",!0)){const c=x(s,r=>{var l;return((l=r.props)==null?void 0:l.children[0][1].type.name)=="FriendPresence"});if(c){let r=[];const l=c.props.children[0][1].props.userId,u=A.getState().clientStatuses[l];u&&(u.desktop&&r.unshift(e.createElement(h,{client:"desktop",stat:u.desktop})),u.mobile&&r.unshift(e.createElement(h,{client:"mobile",stat:u.mobile})),u.web&&r.unshift(e.createElement(h,{client:"web",stat:u.web})),r.length&&s.props.children[0].splice(-1,0,e.createElement(O,{statuses:r})))}}});const n=b.after(E,"render",(o,a,s)=>{if(w(i,"member",!0)){const c=x(s,r=>r.props.type==="MEMBER");c&&(b.after(c.type,"type",(r,[l],u)=>{const f=A.getState().clientStatuses[l.userId];f&&(f.web&&u.props.children.push(e.createElement(h,{client:"web",stat:f.web})),f.mobile&&u.props.children.push(e.createElement(h,{client:"mobile",stat:f.mobile})),f.desktop&&u.props.children.push(e.createElement(h,{client:"desktop",stat:f.desktop})))}),n())}});re.forEach(o=>{b.after(o,"default",(a,[s],c)=>{if(w(i,"profile",!0)){let r=[];const l=A.getState().clientStatuses[s.user.id];if(l&&(l.desktop&&r.unshift(e.createElement(h,{client:"desktop",stat:l.desktop})),l.mobile&&r.unshift(e.createElement(h,{client:"mobile",stat:l.mobile})),l.web&&r.unshift(e.createElement(h,{client:"web",stat:l.web})),r.length))if(c)(c.props.badges?c.props.badges:c.props.children).unshift(...r);else return e.createElement(O,{statuses:r})}})})},onStop(){b.unpatchAll()},getSettingsPanel({settings:n}){return e.createElement(ie,{settings:n})}};H(ce);
