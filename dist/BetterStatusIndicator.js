function $(t){window.enmity.plugins.registerPlugin(t)}const b=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const e=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const Y=window.enmity.modules.common.Toasts;window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const j=window.enmity.modules.common.Navigation;window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme;const L=window.enmity.modules.common.Linking,M=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function q(t){return window.enmity.patcher.create(t)}var l="BetterStatusIndicator",x="1.0.1",G="Reveal statuses for every platform user is using with customizable color.",K=[{name:"mafu",id:"519760564755365888"}],W="#da70d6",X={name:l,version:x,description:G,authors:K,color:W};const{components:n}=window.enmity;n.Alert,n.Button,n.FlatList;const N=n.Image;n.ImageBackground,n.KeyboardAvoidingView,n.Modal;const J=n.Pressable;n.RefreshControl;const Q=n.ScrollView;n.SectionList,n.StatusBar,n.StyleSheet,n.Switch;const T=n.Text;n.TextInput,n.TouchableHighlight;const Z=n.TouchableOpacity;n.TouchableWithoutFeedback,n.Touchable;const S=n.View;n.VirtualizedList,n.Form,n.FormArrow,n.FormCTA,n.FormCTAButton,n.FormCardSection,n.FormCheckbox,n.FormDivider,n.FormHint,n.FormIcon,n.FormInput,n.FormLabel,n.FormRadio;const a=n.FormRow,A=n.FormSection;n.FormSelect,n.FormSubLabel;const F=n.FormSwitch;n.FormTernaryCheckBox,n.FormText,n.FormTextColors,n.FormTextSizes;function w(t){return window.enmity.assets.getIDByName(t)}function v(...t){return window.enmity.modules.getByProps(...t)}function R(...t){return window.enmity.modules.getByName(...t)}window.enmity.modules.common;function y(t){return"#"+("000000"+t.toString(16)).slice(-6)}const O=v("openLazy","hideActionSheet"),ee=R("CustomColorPickerActionSheet",{default:!1}).default;function C({label:t,color:o,setColor:s,leading:m,onSelect:d=void 0}){const i=M.createThemedStyleSheet({pickedColorText:{color:b.ThemeColorMap.TEXT_NORMAL,marginLeft:10,fontSize:16,width:72,fontFamily:b.Fonts.PRIMARY_MEDIUM},pickerColorPreview:{width:24,height:24,backgroundColor:y(o),borderRadius:3,borderWidth:1,borderColor:b.ThemeColorMap.HEADER_SECONDARY}});return e.createElement(a,{label:t,trailing:e.createElement(S,{style:{flexDirection:"row",alignItems:"center"}},e.createElement(S,{style:i.pickerColorPreview}),e.createElement(T,{style:i.pickedColorText},y(o)),e.createElement(a.Arrow,null)),leading:e.createElement(a.Icon,{source:w(m),style:{tintColor:y(o)}}),onPress:()=>{O.openLazy(new Promise(r=>r({default:ee})),"CustomColorPickerActionSheet",{color:o,onSelect:r=>{s(r),d&&d(r),O.hideActionSheet()}})}})}function h(t,o,s){window.enmity.settings.set(t,o,s)}function g(t,o,s){return window.enmity.settings.get(t,o,s)}const te=w("img_account_sync_github_white"),ne=w("Discord"),oe=w("img_account_sync_twitter_white"),ie=w("ic_message_retry"),re=w("ic_members"),le=w("ic_friend_wave_24px"),ae=w("ic_profile_24px"),se=v("acceptInviteAndTransitionToInviteChannel");var me=({settings:t})=>{const o=M.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:25,paddingTop:20,paddingLeft:20,paddingRight:30,color:b.ThemeColorMap.HEADER_PRIMARY,fontFamily:b.Fonts.PRIMARY_MEDIUM},author:{fontSize:15,paddingLeft:50,color:b.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:b.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}}),[s,m]=e.useState(g(l,"online",3908956)),[d,i]=e.useState(g(l,"offline",7634829)),[r,c]=e.useState(g(l,"idle",16426522)),[p,B]=e.useState(g(l,"dnd",15548997)),[U,D]=e.useState(g(l,"streaming",5846677));return e.createElement(Q,null,e.createElement(S,{style:o.container},e.createElement(N,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:o.image}),e.createElement(S,{style:o.title},e.createElement(T,{style:o.name},"BetterStatusIndicator"),e.createElement(T,{style:o.author},"by mafu"))),e.createElement(A,{title:"COLOR"},e.createElement(C,{label:"Online",color:s,setColor:m,leading:"StatusOnline",onSelect:u=>{h(l,"online",u)}}),e.createElement(C,{label:"Offline",color:d,setColor:i,leading:"StatusOffline",onSelect:u=>{h(l,"offline",u)}}),e.createElement(C,{label:"Idle",color:r,setColor:c,leading:"StatusIdle",onSelect:u=>{h(l,"idle",u)}}),e.createElement(C,{label:"DND",color:p,setColor:B,leading:"StatusDND",onSelect:u=>{h(l,"dnd",u)}}),e.createElement(C,{label:"Streaming",color:U,setColor:D,leading:"StatusStreaming",onSelect:u=>{h(l,"streaming",u)}}),e.createElement(a,{label:"Reset to default",trailing:a.Arrow,leading:e.createElement(a.Icon,{source:ie}),onPress:()=>{h(l,"offline",7634829),i(7634829),h(l,"online",3908956),m(3908956),h(l,"idle",16426522),c(16426522),h(l,"dnd",15548997),B(15548997),h(l,"streaming",5846677),D(5846677)}})),e.createElement(A,{title:"PLACE"},e.createElement(a,{label:"Member List",leading:e.createElement(a.Icon,{source:re}),trailing:e.createElement(F,{value:t.getBoolean("member",!0),onValueChange:u=>{t.set("member",u)}})}),e.createElement(a,{label:"Friends Tab",leading:e.createElement(a.Icon,{source:le}),trailing:e.createElement(F,{value:t.getBoolean("friend",!0),onValueChange:u=>{t.set("friend",u)}})}),e.createElement(a,{label:"Profile",leading:e.createElement(a.Icon,{source:ae}),trailing:e.createElement(F,{value:t.getBoolean("profile",!0),onValueChange:u=>{t.set("profile",u)}})})),e.createElement(A,{title:"INFORMATION"},e.createElement(a,{label:"Follow me on Twitter",style:o.info,trailing:a.Arrow,leading:e.createElement(a.Icon,{source:oe}),onPress:()=>{L.openURL("https://twitter.com/m4fn3")}}),e.createElement(a,{label:"Visit my server for help",style:o.info,trailing:a.Arrow,leading:e.createElement(a.Icon,{source:ne}),onPress:()=>{se.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{j.pop()}})}}),e.createElement(a,{label:"Check Source on GitHub",style:o.info,trailing:a.Arrow,leading:e.createElement(a.Icon,{source:te}),onPress:()=>{L.openURL("https://github.com/m4fn3/BetterStatusIndicator")}})),e.createElement(T,{style:o.footer},`v${x}`))};function V(t,o,s){return window.enmity.utilities.findInReactTree(t,o,s)}const{native:I}=window.enmity;I.version;const ce=I.build;I.device,I.version;const E=q("BetterStatusIndicator"),_=v("setCurrentUserOnConnectionOpen");let z=R("ProfileBadges",{all:!0,default:!1});const H=v("ProfileBadgesOld"),de=R("Status",{default:!1}),ue=w("ic_mobile_status"),we=w("ic_monitor_24px"),ge=w("ic_public"),pe=w("ic_robot_24px");function k(t){let o=y(g(l,"offline",7634829));return t=="online"?o=y(g(l,"online",3908956)):t=="idle"?o=y(g(l,"idle",16426522)):t=="dnd"?o=y(g(l,"dnd",15548997)):t=="streaming"&&(o=y(g(l,"streaming",5846677))),o}function fe(t){let o="StatusOffline";return t=="online"?o="StatusOnline":t=="idle"?o="StatusIdle":t=="dnd"?o="StatusDND":t=="streaming"&&(o="StatusStreaming"),w(o)}function f({client:t,stat:o}){let s=ge,m;return t=="desktop"?(s=we,m={}):t=="mobile"?(s=ue,m={marginRight:5,marginLeft:8}):t=="web"?m={height:20,width:20,marginRight:2,marginLeft:2}:t=="bot"&&(s=pe,m={}),e.createElement(Z,{onPress:()=>Y.open({content:`${o} (${t.charAt(0).toUpperCase()}${t.slice(1)})`,source:fe(o)})},e.createElement(N,{source:s,style:{tintColor:k(o),marginLeft:5,...m}}))}function P({statuses:t}){return e.createElement(S,{style:{flexDirection:"row",marginRight:10,alignItems:"center"}},...t)}const he={...X,onStart(){E.after(de,"default",(o,[s],m)=>{m.props.children.props.style.tintColor=s.streaming?k("streaming"):k(s.status)}),E.after(J.type,"render",(o,s,m)=>{if(g(l,"friend",!0)){const d=V(m,i=>{var r;return((r=i.props)==null?void 0:r.children[0][1].type.name)=="FriendPresence"});if(d){let i=[];const r=d.props.children[0][1].props.userId,c=_.getState().clientStatuses[r];c&&(c.desktop&&i.unshift(e.createElement(f,{client:"desktop",stat:c.desktop})),c.mobile&&i.unshift(e.createElement(f,{client:"mobile",stat:c.mobile})),c.web&&i.unshift(e.createElement(f,{client:"web",stat:c.web})),i.length&&m.props.children[0].splice(-1,0,e.createElement(P,{statuses:i})))}}});const t=E.after(S,"render",(o,s,m)=>{if(g(l,"member",!0)){const d=V(m,i=>i.props.type==="MEMBER");d&&(E.after(d.type,"type",(i,[r],c)=>{const p=_.getState().clientStatuses[r.userId];p&&(r.user.bot?p.web&&c.props.children.push(e.createElement(f,{client:"bot",stat:p.web})):(p.web&&c.props.children.push(e.createElement(f,{client:"web",stat:p.web})),p.mobile&&c.props.children.push(e.createElement(f,{client:"mobile",stat:p.mobile})),p.desktop&&c.props.children.push(e.createElement(f,{client:"desktop",stat:p.desktop}))))}),t())}});H&&ce>="42235"&&(z=[H]),z.forEach(o=>{E.after(o,"default",(s,[m],d)=>{if(g(l,"profile",!0)){let i=[];const r=_.getState().clientStatuses[m.user.id];if(r&&(m.user.bot?r.web&&i.unshift(e.createElement(f,{client:"bot",stat:r.web})):(r.desktop&&i.unshift(e.createElement(f,{client:"desktop",stat:r.desktop})),r.mobile&&i.unshift(e.createElement(f,{client:"mobile",stat:r.mobile})),r.web&&i.unshift(e.createElement(f,{client:"web",stat:r.web}))),i.length))if(d){let c=d.props.badges?d.props.badges:d.props.children;if(c)c.unshift(...i);else return e.createElement(P,{statuses:i})}else return e.createElement(P,{statuses:i})}})})},onStop(){E.unpatchAll()},getSettingsPanel({settings:t}){return e.createElement(me,{settings:t})}};$(he);
